% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/NMFprofileR.R
\name{NMFprofileR}
\alias{NMFprofileR}
\title{Perform a Full Multi-Rank NMF and Functional Enrichment Analysis}
\usage{
NMFprofileR(
  expression_data,
  nmf_rank = 2:5,
  output_prefix,
  gene_list_filter_file = NULL,
  expression_threshold = 10,
  variance_quantile = 0.7,
  nmf_method = "brunet",
  nmf_nrun = 50,
  nmf_seed = 123456,
  gprofiler_organism = "hsapiens",
  gprofiler_sources = c("GO:BP", "GO:MF", "REAC", "KEGG", "TF"),
  gprofiler_correction = "g_SCS",
  gprofiler_cutoff = 0.05,
  enrichment_plot_top_n = 20
)
}
\arguments{
\item{expression_data}{A data frame or matrix of normalized, non-negative
gene expression values. Rows should represent genes (with gene symbols as
rownames) and columns should represent samples.}

\item{nmf_rank}{An integer vector specifying the factorization ranks (k) to
test (e.g., `2:5`).}

\item{output_prefix}{A character string defining the base path and file name
prefix for all output files and directories. For example, `"results/MyAnalysis"`.}

\item{gene_list_filter_file}{An optional character string path to a plain text
file containing a list of gene symbols (one per line). If provided, the
expression matrix will be pre-filtered to include only these genes.}

\item{expression_threshold}{A numeric value. Genes with a mean expression
across all samples below this threshold will be removed prior to NMF.}

\item{variance_quantile}{A numeric value between 0 and 1. After mean-based
filtering, genes with variance below this quantile are removed. This step
enriches for more informative genes.}

\item{nmf_method}{A character string specifying the NMF algorithm to use.
Defaults to 'brunet'. See the `NMF::nmf` documentation for other options.}

\item{nmf_nrun}{An integer specifying the number of runs for the consensus NMF.
A higher number (e.g., 50-100) provides more stable results.}

\item{nmf_seed}{An integer to use as the random seed for reproducibility.}

\item{gprofiler_organism}{A character string specifying the organism for
g:Profiler enrichment analysis (e.g., 'hsapiens', 'mmusculus').}

\item{gprofiler_sources}{A character vector of data sources to query in
g:Profiler (e.g., c("GO:BP", "REAC", "KEGG")).}

\item{gprofiler_correction}{A character string specifying the multiple testing
correction method used by g:Profiler.}

\item{gprofiler_cutoff}{A numeric value for the significance threshold for
enrichment results.}

\item{enrichment_plot_top_n}{An integer specifying the number of top enriched
terms to display in the summary dot plots.}
}
\value{
A single data frame (`consolidated_summary_df`) containing a detailed
  summary for every factor from every rank tested. All detailed results, plots,
  and log files are saved to disk at the location specified by `output_prefix`.
}
\description{
This function is the main entry point for the NMFprofileR workflow. It
orchestrates the entire analysis pipeline, from preprocessing the input
expression matrix to performing a multi-rank NMF analysis, extracting basis
genes, running functional enrichment, and generating a comprehensive suite of
visualizations and summary reports.
}
